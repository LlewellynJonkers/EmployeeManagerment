{% extends "layout.html" %}

{% block title %}Employees{% endblock %}

{% block content %}
<div class="d-flex justify-content-between mb-3">
  <h2 class="page-title">Assistants</h2>
  <!--<a href="{{ url_for('upload.upload_employees')}}" class="btn btn-primary">Add Bulk Employees</a>-->
</div>

<!-- Search Bar -->
<form method="GET" class="mb-3 d-flex" action="{{ url_for('employee.index') }}">
  <input type="text" name="q" value="{{ request.args.get('q', '') }}" class="form-control me-2" placeholder="Search employees...">
  <button type="submit" class="btn btn-outline-primary">Search</button>
</form>

<div class="card">
  <div class="table-responsive">
    <table class="table table-vcenter card-table">
      <thead>
        <tr>
          <th>ID</th>
          <th>Full Name</th>
          <th>School</th>
          <th>Role</th>
          <th>Status</th>
          <th class="w-1">Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for emp in pagination.items %}
        <tr>
          <td>{{ emp.id_number }}</td>
          <td>{{ emp.surname }} {{ emp.firstname }}</td>
          <td>{{ emp.school.name }}</td>
          <td>{{ emp.role if emp.role else '' }}</td>
          <td>
            <span class="badge {% if emp.contract_status == 'Active' %} bg-green {% else %} bg-red {% endif %}">
              {{ emp.status }}
            </span>
          </td>
          <td>
            <div class="btn-list flex-nowrap">
              <a href="#" class="btn btn-sm btn-outline-secondary">Edit</a>
              <a href="#" class="btn btn-sm btn-outline-danger">Delete</a>
            </div>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<!-- Pagination -->
<div class="mt-3">
  <ul class="pagination">
    {% if pagination.has_prev %}
      <li class="page-item">
        <a class="page-link" href="{{ url_for('employee.index', page=pagination.prev_num) }}">Previous</a>
      </li>
    {% else %}
      <li class="page-item disabled"><span class="page-link">Previous</span></li>
    {% endif %}

    {% for page_num in pagination.iter_pages(left_edge=2, right_edge=2, left_current=2, right_current=2) %}
      {% if page_num %}
        <li class="page-item {% if page_num == pagination.page %}active{% endif %}">
          <a class="page-link" href="{{ url_for('employee.index', page=page_num) }}">{{ page_num }}</a>
        </li>
      {% else %}
        <li class="page-item disabled"><span class="page-link">â€¦</span></li>
      {% endif %}
    {% endfor %}

    {% if pagination.has_next %}
      <li class="page-item">
        <a class="page-link" href="{{ url_for('employee.index', page=pagination.next_num) }}">Next</a>
      </li>
    {% else %}
      <li class="page-item disabled"><span class="page-link">Next</span></li>
    {% endif %}
  </ul>
</div>

{% endblock %}
